---
const testimonials = [
  {
    image: "/images/avatars/IMG_1112.JPG",
    name: "Alex Fries",
    title: "National Council member, former chapter president Nu Beta",
    quote: "Joining Phi Mu Delta is about more than joining a chapter. It is about joining a brotherhood of future friends, colleagues and partners in your pursuit of the common good, no matter the arena you choose to enter. Conclave is where that ideal becomes real."
  },
  {
    image: "/images/avatars/1714137500084.jpeg",
    name: "Michael Doran",
    title: "National Council member, former chapter president Mu Alpha",
    quote: "We spend most of our lives inside our bubbles, in our own built communities. Conclaves are the chance to pop those bubbles and share ideas, successes, failures and support across the national fraternity in distance and generation. Living our creed reaching beyond the limits of distance and time to be together as brothers."
  },
  {
    image: "/images/avatars/1693961796462_orig.jpeg",
    name: "Thomas Stephen",
    title: "National Treasurer, former chapter president Nu Beta",
    quote: "Conclave is the expression of our Phi Mu Delta values! Spending time with brothers, old and new, it reminds me of all the good we can create in the world."
  }
];
---

<section class="testimonials-section" id="reviews">
  <div class="testimonials-container">
    <div class="testimonials-header">
      <h2 class="testimonials-title">Why Attend Conclave</h2>
      <p class="testimonials-subtitle">Hear from brothers who've experienced the power of gathering together</p>
    </div>

    <div class="slider-wrapper">
      <button class="slider-arrow slider-arrow-left" aria-label="Previous testimonial">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>

      <div class="slider-track">
        {testimonials.map((t, i) => (
          <div class={`testimonial-card ${i === 0 ? 'active' : ''}`} data-index={i}>
            <div class="testimonial-image-wrapper">
              <img src={t.image} alt={t.name} class="testimonial-image" loading="lazy" />
            </div>
            <div class="testimonial-content">
              <blockquote class="testimonial-quote">"{t.quote}"</blockquote>
              <div class="testimonial-author">
                <span class="testimonial-name">{t.name}</span>
                <span class="testimonial-title">{t.title}</span>
              </div>
            </div>
          </div>
        ))}
      </div>

      <button class="slider-arrow slider-arrow-right" aria-label="Next testimonial">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>
    </div>

    <div class="slider-dots">
      {testimonials.map((_, i) => (
        <button class={`slider-dot ${i === 0 ? 'active' : ''}`} data-index={i} aria-label={`Go to testimonial ${i + 1}`}></button>
      ))}
    </div>
  </div>
</section>

<style>
  .testimonials-section {
    background: #212322;
    padding: 5rem 1rem;
  }

  .testimonials-container {
    max-width: 900px;
    margin: 0 auto;
  }

  .testimonials-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .testimonials-title {
    font-family: 'Have Heart One', cursive;
    font-size: clamp(2.5rem, 6vw, 4rem);
    color: white;
    margin-bottom: 0.75rem;
  }

  .testimonials-subtitle {
    font-family: 'Inter', sans-serif;
    font-size: clamp(0.9rem, 2vw, 1.1rem);
    font-weight: 300;
    color: #9ca3af;
  }

  .slider-wrapper {
    display: flex;
    align-items: center;
    gap: 1rem;
    position: relative;
  }

  .slider-track {
    flex: 1;
    overflow: hidden;
    position: relative;
    min-height: 400px;
  }

  .testimonial-card {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    opacity: 0;
    transform: translateX(50px);
    transition: all 0.5s ease;
    pointer-events: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 2rem;
  }

  .testimonial-card.active {
    opacity: 1;
    transform: translateX(0);
    pointer-events: auto;
  }

  .testimonial-image-wrapper {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    overflow: hidden;
    margin-bottom: 1.5rem;
    border: 4px solid #ea7600;
    box-shadow: 0 8px 30px rgba(234, 118, 0, 0.3);
  }

  .testimonial-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .testimonial-content {
    max-width: 700px;
  }

  .testimonial-quote {
    font-family: 'Inter', sans-serif;
    font-size: clamp(1rem, 2vw, 1.2rem);
    font-weight: 300;
    line-height: 1.8;
    color: #e5e7eb;
    margin-bottom: 1.5rem;
    font-style: italic;
  }

  .testimonial-author {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .testimonial-name {
    font-family: 'Inter', sans-serif;
    font-size: 1.1rem;
    font-weight: 600;
    color: #ea7600;
  }

  .testimonial-title {
    font-family: 'Inter', sans-serif;
    font-size: 0.85rem;
    font-weight: 400;
    color: #9ca3af;
  }

  .slider-arrow {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: rgba(234, 118, 0, 0.15);
    border: 2px solid #ea7600;
    color: #ea7600;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    flex-shrink: 0;
  }

  .slider-arrow:hover {
    background: #ea7600;
    color: #212322;
    transform: scale(1.1);
  }

  .slider-dots {
    display: flex;
    justify-content: center;
    gap: 0.75rem;
    margin-top: 2rem;
  }

  .slider-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: rgba(234, 118, 0, 0.3);
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .slider-dot.active,
  .slider-dot:hover {
    background: #ea7600;
    transform: scale(1.2);
  }

  @media (max-width: 768px) {
    .slider-arrow {
      width: 40px;
      height: 40px;
    }

    .slider-track {
      min-height: 450px;
    }

    .testimonial-card {
      padding: 1rem;
    }

    .testimonial-image-wrapper {
      width: 100px;
      height: 100px;
    }
  }

  @media (max-width: 480px) {
    .slider-arrow {
      display: none;
    }

    .slider-wrapper {
      padding: 0;
    }

    .slider-track {
      min-height: 500px;
    }
  }
</style>

<script>
  const cards = document.querySelectorAll('.testimonial-card');
  const dots = document.querySelectorAll('.slider-dot');
  const prevBtn = document.querySelector('.slider-arrow-left');
  const nextBtn = document.querySelector('.slider-arrow-right');
  let current = 0;
  const total = cards.length;

  function showSlide(index) {
    cards.forEach((card, i) => {
      card.classList.toggle('active', i === index);
    });
    dots.forEach((dot, i) => {
      dot.classList.toggle('active', i === index);
    });
    current = index;
  }

  function nextSlide() {
    showSlide((current + 1) % total);
  }

  function prevSlide() {
    showSlide((current - 1 + total) % total);
  }

  prevBtn?.addEventListener('click', prevSlide);
  nextBtn?.addEventListener('click', nextSlide);

  dots.forEach((dot, i) => {
    dot.addEventListener('click', () => showSlide(i));
  });

  // Auto-advance every 6 seconds
  setInterval(nextSlide, 6000);

  // Touch/swipe support
  let touchStartX = 0;
  let touchEndX = 0;
  const track = document.querySelector('.slider-track');
  
  track?.addEventListener('touchstart', (e) => {
    touchStartX = e.changedTouches[0].screenX;
  }, { passive: true });

  track?.addEventListener('touchend', (e) => {
    touchEndX = e.changedTouches[0].screenX;
    if (touchStartX - touchEndX > 50) nextSlide();
    if (touchEndX - touchStartX > 50) prevSlide();
  }, { passive: true });
</script>
